{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function fetchImages(params) {\n  const url = `https://pixabay.com/api/?${params}`;\n  const response = await axios(url);\n  if (response.data.hits.length === 0) {\n    return;\n  }\n  return response.data;\n}\n","export const imgGallery = document.querySelector('.img-list');\n\nexport function createMarkup(array) {\n  const markup = array\n    .map(\n      ({\n        id,\n        largeImageURL,\n        previewURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"list-item\">\n          <a href=\"${largeImageURL}\" class=\"list-link\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"item-img\" width=\"360\" height=\"160\">\n          </a>\n         <ul class=\"list-review\">\n           <li class=\"review-item\">\n              <h3 class=\"review-title\">likes</h3>\n              <p class=\"review-text\">${likes}</p></li>\n           <li class=\"review-item\">\n              <h3 class=\"review-title\">views</h3>\n              <p class=\"review-text\">${views}</p></li>\n           <li class=\"review-item\">\n              <h3 class=\"review-title\">comments</h3>\n              <p class=\"review-text\">${comments}</p></li>\n           <li class=\"review-item\">\n              <h3 class=\"review-title\">downloads</h3>\n              <p class=\"review-text\">${downloads}</p></li>\n            </ul>\n          </li>`\n    )\n    .join('');\n  imgGallery.insertAdjacentHTML('beforeend', markup);\n}\n\nexport function showLoader() {\n  const loader = document.querySelector('.loader');\n  loader.style.display = 'block';\n}\n\nexport function hideLoader() {\n  const loader = document.querySelector('.loader');\n  loader.style.display = 'none';\n}\n","import iziToast from 'izitoast';\n\nimport SimpleLightbox from 'simplelightbox';\n\nimport { fetchImages } from './js/pixabay-api';\n\nimport {\n  createMarkup,\n  showLoader,\n  hideLoader,\n  imgGallery,\n} from './js/render-functions';\n\nconst form = document.querySelector('.search-form');\nform.addEventListener('submit', onSubmit);\nconst btnLoadMore = document.querySelector('.btn-load-more');\nbtnLoadMore.addEventListener('click', onLoad);\n\nlet userSearch = '';\nlet page;\nlet limit = 15;\nlet totalHits;\n\nconst API_KEY = '43226276-a07a0c17e428cfffb021b9b05';\nconst params = new URLSearchParams({\n  key: API_KEY,\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  q: userSearch,\n  per_page: limit,\n  page: page,\n});\n\nasync function onSubmit(event) {\n  event.preventDefault();\n  page = 1;\n  imgGallery.innerHTML = '';\n  const elements = event.target.elements;\n  userSearch = elements.images.value.trim();\n  if (userSearch === '') {\n    return;\n  }\n  btnLoadMore.style.display = 'none';\n  params.set('q', userSearch);\n  try {\n    showLoader();\n\n    const data = await fetchImages(params);\n    totalHits = data.totalHits;\n    createMarkup(data.hits);\n    gallery.refresh();\n\n    const galleryCard = document.querySelector('.list-item');\n    const cardHeight = galleryCard.getBoundingClientRect().height;\n    window.scrollBy({\n      top: cardHeight * 2.7,\n      behavior: 'smooth',\n    });\n\n    if (totalHits > limit) {\n      page += 1;\n      btnLoadMore.style.display = 'block';\n    }\n  } catch (error) {\n    iziToast.show(iziTParams);\n  } finally {\n    hideLoader();\n  }\n  form.reset();\n}\n\nasync function onLoad(event) {\n  const totalPages = Math.ceil(totalHits / limit);\n  params.set('page', page);\n\n  try {\n    showLoader();\n    const data = await fetchImages(params);\n    totalHits = data.totalHits;\n    createMarkup(data.hits);\n    gallery.refresh();\n    const galleryCard = document.querySelector('.list-item');\n    const cardHeight = galleryCard.getBoundingClientRect().height;\n    window.scrollBy({\n      top: cardHeight * 2.7,\n      behavior: 'smooth',\n    });\n    if (page < totalPages) {\n      page += 1;\n    } else if (page === totalPages) {\n      btnLoadMore.style.display = 'none';\n      iziTParams.message =\n        \"We're sorry, but you've reached the end of search results.\";\n      iziToast.show(iziTParams);\n    }\n  } catch (error) {\n    iziToast.show(iziTParams);\n  }\n  hideLoader();\n}\n\nlet gallery = new SimpleLightbox('.img-list .list-link', {\n  overlayOpacity: 0.8,\n  captionsData: 'alt',\n  captionDelay: 250,\n  captionPosition: 'bottom',\n});\n\ngallery.on('shown.simplelightbox', function () {\n  const enlargedImg = document.querySelector('.sl-image > img');\n  enlargedImg.style.width = '100%';\n  enlargedImg.style.maxHeight = '100%';\n});\n\nconst iziTParams = {\n  titleColor: '#fff',\n  message:\n    'Sorry, there are no images matching<br>your search query.Please try again!',\n  messageColor: '#fff',\n  messageSize: '16px',\n  messageLineHeight: '150%',\n  backgroundColor: ' #ef4040',\n  // icon: 'errIcon',\n  iconUrl: 'img/error.svg',\n  position: 'topRight',\n  close: true,\n  closeOnEscape: false,\n  closeOnClick: false,\n  timeout: 5000,\n  resetOnHover: true,\n  transitionIn: 'flipInX',\n  transitionOut: 'flipOutX',\n};\n"],"names":["fetchImages","params","url","response","axios","imgGallery","createMarkup","array","markup","id","largeImageURL","previewURL","webformatURL","tags","likes","views","comments","downloads","showLoader","loader","hideLoader","form","onSubmit","btnLoadMore","onLoad","userSearch","page","limit","totalHits","API_KEY","event","data","gallery","cardHeight","iziToast","iziTParams","totalPages","SimpleLightbox","enlargedImg"],"mappings":"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"}